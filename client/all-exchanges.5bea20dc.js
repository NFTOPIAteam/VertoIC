import{S as t,i as e,s as n,v as s,b as a,d as r,e as o,t as l,M as i,j as c,h as u,m as f,f as d,g as m,k as h,o as v,I as g,p,r as $,q as b,B as y,y as T,D as w,u as j,z as E,E as S,N as D,X as x,Z as k,C as q,w as N,J as A,R as B,x as H,a as R,G as Y,H as P}from"./client.0f0e9ea5.js";import{a as I,A as M}from"./settings.bc92b9ed.js";import{N as V}from"./NavBar.504604fd.js";import{F as C}from"./Footer.a900e9c6.js";import{q as L}from"./api-client.40028785.js";import{e as O,p as z}from"./constants.b14b1131.js";import{m as F}from"./moment.7288240e.js";import{S as J}from"./SkeletonLoading.003a53ee.js";import{L as X}from"./Loading.f68b7627.js";var _='query($owners: [String!], $contractSrc: [String!]!) {\n  transactions(\n    owners: $owners\n    tags: [\n      { name: "Exchange", values: "Verto" }\n      { name: "Type", values: "PST" }\n      { name: "Contract", values: $contractSrc }\n    ]\n  ) {\n    edges {\n      node {\n        id\n      }\n    }\n  }\n}\n';const{setTimeout:G}=k;function Z(t,e,n){const s=t.slice();return s[19]=e[n],s}function K(t,e,n){const s=t.slice();return s[16]=e[n],s}function Q(t){let e,n,s,r,i,f,g,$,y,E,S,D,x,k,N=t[5],A=[];for(let e=0;e<N.length;e+=1)A[e]=tt(Z(t,N,e));let B=t[4]&&et();return{c(){e=o("table"),n=o("tr"),s=o("th"),r=l("Timestamp"),i=a(),f=o("th"),g=l("Trade"),$=a(),y=o("th"),E=l("Duration"),S=a();for(let t=0;t<A.length;t+=1)A[t].c();D=a(),B&&B.c(),x=Y(),this.h()},l(t){e=d(t,"TABLE",{class:!0});var a=m(e);n=d(a,"TR",{class:!0});var o=m(n);s=d(o,"TH",{class:!0});var l=m(s);r=h(l,"Timestamp"),l.forEach(c),i=u(o),f=d(o,"TH",{class:!0});var v=m(f);g=h(v,"Trade"),v.forEach(c),$=u(o),y=d(o,"TH",{class:!0});var p=m(y);E=h(p,"Duration"),p.forEach(c),o.forEach(c),S=u(a);for(let t=0;t<A.length;t+=1)A[t].l(a);a.forEach(c),D=u(t),B&&B.l(t),x=Y(),this.h()},h(){v(s,"class","svelte-njbb31"),v(f,"class","svelte-njbb31"),v(y,"class","svelte-njbb31"),v(n,"class","svelte-njbb31"),v(e,"class","svelte-njbb31")},m(t,a){p(t,e,a),b(e,n),b(n,s),b(s,r),b(n,i),b(n,f),b(f,g),b(n,$),b(n,y),b(y,E),b(e,S);for(let t=0;t<A.length;t+=1)A[t].m(e,null);p(t,D,a),B&&B.m(t,a),p(t,x,a),k=!0},p(t,n){if(32&n){let s;for(N=t[5],s=0;s<N.length;s+=1){const a=Z(t,N,s);A[s]?(A[s].p(a,n),j(A[s],1)):(A[s]=tt(a),A[s].c(),j(A[s],1),A[s].m(e,null))}for(;s<A.length;s+=1)A[s].d(1);A.length=N.length}t[4]?B?16&n&&j(B,1):(B=et(),B.c(),j(B,1),B.m(x.parentNode,x)):B&&(q(),T(B,1,1,(()=>{B=null})),w())},i(t){if(!k){for(let t=0;t<N.length;t+=1)j(A[t]);j(B),k=!0}},o(t){T(B),k=!1},d(t){t&&c(e),P(A,t),t&&c(D),B&&B.d(t),t&&c(x)}}}function U(t){let e,n;return{c(){e=o("p"),n=l("No trades found."),this.h()},l(t){e=d(t,"P",{class:!0});var s=m(e);n=h(s,"No trades found."),s.forEach(c),this.h()},h(){v(e,"class","svelte-njbb31")},m(t,s){p(t,e,s),b(e,n)},p:R,i:R,o:R,d(t){t&&c(e)}}}function W(t){let e,n,s,r,i,f,g,$,y,w,E,S,D=Array(10),x=[];for(let e=0;e<D.length;e+=1)x[e]=nt(K(t,D,e));return{c(){e=o("table"),n=o("tr"),s=o("th"),r=l("Timestamp"),i=a(),f=o("th"),g=l("Trade"),$=a(),y=o("th"),w=l("Duration"),E=a();for(let t=0;t<x.length;t+=1)x[t].c();this.h()},l(t){e=d(t,"TABLE",{class:!0});var a=m(e);n=d(a,"TR",{class:!0});var o=m(n);s=d(o,"TH",{class:!0});var l=m(s);r=h(l,"Timestamp"),l.forEach(c),i=u(o),f=d(o,"TH",{class:!0});var v=m(f);g=h(v,"Trade"),v.forEach(c),$=u(o),y=d(o,"TH",{class:!0});var p=m(y);w=h(p,"Duration"),p.forEach(c),o.forEach(c),E=u(a);for(let t=0;t<x.length;t+=1)x[t].l(a);a.forEach(c),this.h()},h(){v(s,"class","svelte-njbb31"),v(f,"class","svelte-njbb31"),v(y,"class","svelte-njbb31"),v(n,"class","svelte-njbb31"),v(e,"class","svelte-njbb31")},m(t,a){p(t,e,a),b(e,n),b(n,s),b(s,r),b(n,i),b(n,f),b(f,g),b(n,$),b(n,y),b(y,w),b(e,E);for(let t=0;t<x.length;t+=1)x[t].m(e,null);S=!0},p:R,i(t){if(!S){for(let t=0;t<D.length;t+=1)j(x[t]);S=!0}},o(t){x=x.filter(Boolean);for(let t=0;t<x.length;t+=1)T(x[t]);S=!1},d(t){t&&c(e),P(x,t)}}}function tt(t){let e,n,r,i,f,$,y,T,w,j,E,S,D,x,k,q,A,Y,P=t[19].timestamp+"",I=t[19].sent+"",M=t[19].received+"",V=t[19].duration+"";return{c(){e=o("tr"),n=o("td"),r=l(P),i=a(),f=o("td"),$=l(I),y=a(),T=l("->"),w=a(),j=l(M),E=a(),S=o("span"),x=a(),k=o("td"),q=l(V),A=a(),this.h()},l(t){e=d(t,"TR",{class:!0});var s=m(e);n=d(s,"TD",{style:!0,class:!0});var a=m(n);r=h(a,P),a.forEach(c),i=u(s),f=d(s,"TD",{style:!0,class:!0});var o=m(f);$=h(o,I),y=u(o),T=h(o,"->"),w=u(o),j=h(o,M),E=u(o),S=d(o,"SPAN",{class:!0}),m(S).forEach(c),o.forEach(c),x=u(s),k=d(s,"TD",{style:!0,class:!0});var l=m(k);q=h(l,V),l.forEach(c),A=u(s),s.forEach(c),this.h()},h(){g(n,"width","30%"),v(n,"class","svelte-njbb31"),v(S,"class",D="status "+t[19].status+" svelte-njbb31"),g(f,"width","45%"),v(f,"class","svelte-njbb31"),g(k,"text-transform","uppercase"),v(k,"class","svelte-njbb31"),v(e,"class","svelte-njbb31")},m(t,s){p(t,e,s),b(e,n),b(n,r),b(e,i),b(e,f),b(f,$),b(f,y),b(f,T),b(f,w),b(f,j),b(f,E),b(f,S),b(e,x),b(e,k),b(k,q),b(e,A)},p(t,e){32&e&&P!==(P=t[19].timestamp+"")&&B(r,P),32&e&&I!==(I=t[19].sent+"")&&B($,I),32&e&&M!==(M=t[19].received+"")&&B(j,M),32&e&&D!==(D="status "+t[19].status+" svelte-njbb31")&&v(S,"class",D),32&e&&V!==(V=t[19].duration+"")&&B(q,V)},i(t){Y||s((()=>{Y=N(e,H,{duration:300}),Y.start()}))},o:R,d(t){t&&c(e)}}}function et(t){let e,n,s,l;return e=new X({props:{style:"position: absolute; left: 50%;"}}),{c(){r(e.$$.fragment),n=a(),s=o("br")},l(t){f(e.$$.fragment,t),n=u(t),s=d(t,"BR",{})},m(t,a){$(e,t,a),p(t,n,a),p(t,s,a),l=!0},i(t){l||(j(e.$$.fragment,t),l=!0)},o(t){T(e.$$.fragment,t),l=!1},d(t){E(e,t),t&&c(n),t&&c(s)}}}function nt(t){let e,n,s,l,i,h,y,w,S,D,x;return s=new J({props:{style:"width: 100%"}}),h=new J({props:{style:"width: 100%"}}),S=new J({props:{style:"width: 100%"}}),{c(){e=o("tr"),n=o("td"),r(s.$$.fragment),l=a(),i=o("td"),r(h.$$.fragment),y=a(),w=o("td"),r(S.$$.fragment),D=a(),this.h()},l(t){e=d(t,"TR",{class:!0});var a=m(e);n=d(a,"TD",{style:!0,class:!0});var r=m(n);f(s.$$.fragment,r),r.forEach(c),l=u(a),i=d(a,"TD",{style:!0,class:!0});var o=m(i);f(h.$$.fragment,o),o.forEach(c),y=u(a),w=d(a,"TD",{style:!0,class:!0});var v=m(w);f(S.$$.fragment,v),v.forEach(c),D=u(a),a.forEach(c),this.h()},h(){g(n,"width","30%"),v(n,"class","svelte-njbb31"),g(i,"width","45%"),v(i,"class","svelte-njbb31"),g(w,"width","25%"),v(w,"class","svelte-njbb31"),v(e,"class","svelte-njbb31")},m(t,a){p(t,e,a),b(e,n),$(s,n,null),b(e,l),b(e,i),$(h,i,null),b(e,y),b(e,w),$(S,w,null),b(e,D),x=!0},p:R,i(t){x||(j(s.$$.fragment,t),j(h.$$.fragment,t),j(S.$$.fragment,t),x=!0)},o(t){T(s.$$.fragment,t),T(h.$$.fragment,t),T(S.$$.fragment,t),x=!1},d(t){t&&c(e),E(s),E(h),E(S)}}}function st(t){let e,n,D,x,k,A,B,R,Y,P,I,M,L,O,z,F,J,X,_=!1,Z=()=>{_=!1};s(t[7]),s(t[8]),D=new V({});const K=[W,U,Q],tt=[];function et(t,e){return t[3]?0===t[5].length?1:2:0}return Y=et(t),P=tt[Y]=K[Y](t),L=new C({}),{c(){n=a(),r(D.$$.fragment),x=a(),k=o("div"),A=o("h1"),B=l("All Trades"),R=a(),P.c(),M=a(),r(L.$$.fragment),O=a(),z=o("span"),this.h()},l(t){i('[data-svelte="svelte-ckjelo"]',document.head).forEach(c),n=u(t),f(D.$$.fragment,t),x=u(t),k=d(t,"DIV",{class:!0});var e=m(k);A=d(e,"H1",{class:!0});var s=m(A);B=h(s,"All Trades"),s.forEach(c),R=u(e),P.l(e),e.forEach(c),M=u(t),f(L.$$.fragment,t),O=u(t),z=d(t,"SPAN",{style:!0}),m(z).forEach(c),this.h()},h(){document.title="Verto â€” All Exchanges",v(A,"class","title"),v(k,"class","all-exchanges svelte-njbb31"),g(z,"width","100%"),g(z,"height","1px")},m(s,a){p(s,n,a),$(D,s,a),p(s,x,a),p(s,k,a),b(k,A),b(A,B),b(k,R),tt[Y].m(k,null),p(s,M,a),$(L,s,a),p(s,O,a),p(s,z,a),t[9](z),F=!0,J||(X=[y(window,"scroll",(()=>{_=!0,clearTimeout(e),e=G(Z,100),t[7]()})),y(window,"resize",t[8])],J=!0)},p(t,[n]){4&n&&!_&&(_=!0,clearTimeout(e),scrollTo(window.pageXOffset,t[2]),e=G(Z,100));let s=Y;Y=et(t),Y===s?tt[Y].p(t,n):(q(),T(tt[s],1,1,(()=>{tt[s]=null})),w(),P=tt[Y],P?P.p(t,n):(P=tt[Y]=K[Y](t),P.c()),j(P,1),P.m(k,null))},i(t){F||(j(D.$$.fragment,t),j(P),I||s((()=>{I=N(k,H,{duration:400}),I.start()})),j(L.$$.fragment,t),F=!0)},o(t){T(D.$$.fragment,t),T(P),T(L.$$.fragment,t),F=!1},d(e){e&&c(n),E(D,e),e&&c(x),e&&c(k),tt[Y].d(),e&&c(M),E(L,e),e&&c(O),e&&c(z),t[9](null),J=!1,S(X)}}}function at(t,e,n){let s;D(t,I,(t=>n(11,s=t)));var a=this&&this.__awaiter||function(t,e,n,s){return new(n||(n=Promise))((function(a,r){function o(t){try{i(s.next(t))}catch(t){r(t)}}function l(t){try{i(s.throw(t))}catch(t){r(t)}}function i(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,l)}i((s=s.apply(t,e||[])).next())}))};let r,o,l,i=[],c="",u=!0,f=!1,d=!1;function m(){return a(this,void 0,void 0,(function*(){if(!u)return;let t=[];n(4,d=!0);const e=(yield L({query:'query($owners: [String!], $num: Int, $recipients: [String!], $cursor: String) {\n  transactions(\n    owners: $owners\n    recipients: $recipients\n    tags: [\n      { name: "Exchange", values: "Verto" }\n      { name: "Type", values: ["Buy", "Sell"] }\n    ]\n    first: $num\n    after: $cursor\n  ) {\n    pageInfo {\n      hasNextPage\n    }\n    edges {\n      cursor\n      node {\n        id\n        block {\n          timestamp\n        }\n        quantity {\n          ar\n        }\n        tags {\n          name\n          value\n        }\n      }\n    }\n  }\n}\n',variables:{owners:[s],cursor:c}})).data.transactions,r=e.edges;n(6,u=e.pageInfo.hasNextPage);const o=yield function(){return a(this,void 0,void 0,(function*(){let t=[];const e=new M({host:"arweave.net",port:443,protocol:"https",timeout:2e4});let n=[];(yield L({query:_,variables:{owners:[O],contractSrc:z}})).data.transactions.edges.map((({node:t})=>{n.push(t.id)}));for(const s of n)try{const n=(yield e.transactions.getData(s,{decode:!0,string:!0})).toString(),a=JSON.parse((yield e.transactions.getData(n,{decode:!0,string:!0})).toString());t.push({id:n,name:a.name,ticker:a.ticker})}catch(t){console.log(t)}return t}))}();r.map((({node:e,cursor:n})=>{var s,a,r,l;c=n;const i=null===(s=e.tags.find((t=>"Type"===t.name)))||void 0===s?void 0:s.value;if(i){const n="Buy"===i?"Token":"Contract",s=null===(a=e.tags.find((t=>t.name===n)))||void 0===a?void 0:a.value,c=null===(r=o.find((t=>t.id===s)))||void 0===r?void 0:r.ticker,u="Buy"===i?parseFloat(e.quantity.ar)+" AR":JSON.parse(null===(l=e.tags.find((t=>"Input"===t.name)))||void 0===l?void 0:l.value).qty+" "+c,f="??? "+("Buy"===i?c:"AR");t.push({id:e.id,timestamp:e.block?F.unix(e.block.timestamp).format("YYYY-MM-DD hh:mm:ss"):"not mined yet",type:i,sent:u,received:f,status:"pending",duration:"not completed"})}}));for(let e=0;e<t.length;e++){const s=(yield L({query:`\n          query {\n            transactions(\n              tags: [\n                { name: "Exchange", values: "Verto" }\n                { name: "Type", values: "Confirmation" }\n                { name: "Match", values: "${t[e].id}" }\n              ]\n            ) {\n              edges {\n                node {\n                  block {\n                    timestamp\n                  }\n                  tags {\n                    name\n                    value\n                  }\n                }\n              }\n            }\n          }\n        `})).data.transactions.edges;if(s[0]){if(t[e].status="success",s[0].node.block){const n=F(t[e].timestamp),a=F(F.unix(s[0].node.block.timestamp).format("YYYY-MM-DD hh:mm:ss")),r=F.duration(a.diff(n));t[e].duration=r.humanize()}else t[e].duration="not mined yet";const n=s[0].node.tags.find((t=>"Received"===t.name));n&&(t[e].received=n.value)}(yield L({query:`\n          query {\n            transactions(\n              tags: [\n                { name: "Exchange", values: "Verto" }\n                { name: "Type", values: "Cancel" }\n                { name: "Order", values: "${t[e].id}" }\n              ]\n            ) {\n              edges {\n                node {\n                  id\n                }\n              }\n            }\n          }\n        `})).data.transactions.edges[0]&&(n(5,i[e].status="failed",i),n(5,i[e].duration="cancelled",i))}n(5,i=i.concat(t)),n(3,f=!0),setTimeout((()=>n(4,d=!1)),400)}))}return x((()=>m())),t.$$.update=()=>{if(95&t.$$.dirty&&void 0!==r){r.offsetTop+r.offsetHeight<=l+o+120&&f&&!d&&u&&m()}},[r,o,l,f,d,i,u,function(){n(2,l=window.pageYOffset)},function(){n(1,o=window.innerHeight)},function(t){A[t?"unshift":"push"]((()=>{r=t,n(0,r)}))}]}export default class extends t{constructor(t){super(),e(this,t,at,st,n,{})}}
